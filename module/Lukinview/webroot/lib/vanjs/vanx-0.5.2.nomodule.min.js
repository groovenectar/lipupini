{let e,t,r,{fromEntries:o,entries:l,keys:n,hasOwn:f,getPrototypeOf:i}=Object,{get:a,set:y,deleteProperty:c,ownKeys:s}=Reflect,{state:m,derive:d,add:u}=van,b=1e3,w=Symbol(),A=Symbol(),_=Symbol(),g=Symbol(),p=Symbol(),S=e=>(e[A]=1,e),P=e=>e instanceof Object&&!(e instanceof Function),h=e=>{if(e?.[A]){let t=m();return d(()=>{let r=e();P(t.rawVal)&&P(r)?E(t.rawVal,r):t.val=O(r)}),t}return m(O(e))},F=e=>{let t=Array.isArray(e)?[]:{__proto__:i(e)};for(let[r,o]of l(e))t[r]=h(o);return t[_]=[],t[g]=m(1),t},O=e=>!P(e)||e[w]?e:new Proxy(F(e),{get:(e,t,r)=>t===w?e:f(e,t)?Array.isArray(e)&&"length"===t?(e[g].val,e.length):e[t].val:a(e,t,r),set:(e,o,l,n)=>f(e,o)?Array.isArray(e)&&"length"===o?(l!==e.length&&++e[g].val,e.length=l,1):(e[o].val=O(l),1):o in e?y(e,o,l,n):y(e,o,h(l))&&(++e[g].val,j(e).forEach(x.bind(t,n,o,e[o],r)),1),deleteProperty:(e,t)=>(c(e,t)&&K(e,t),++e[g].val),ownKeys:e=>(e[g].val,s(e))}),v=e=>e[w],D=e=>e[w]?new Proxy(e[w],{get:(e,t)=>D(e[t].rawVal)}):e,j=e=>e[_]=e[_].filter(e=>e.t.isConnected),x=(e,t,r,o,{t:l,f:f})=>{let i=Array.isArray(e),a=i?Number(t):t;u(l,()=>l[p][t]=f(r,()=>delete e[t],a)),i&&!o&&a!==e.length-1&&l.insertBefore(l.lastChild,l[p][n(e).find(e=>Number(e)>a)])},K=(e,t)=>{for(let r of j(e)){let e=r.t[p];e[t]?.remove(),delete e[t]}},N=r=>(e??(setTimeout(()=>(e.forEach(j),e=t),b),e=new Set)).add(r),k=(e,t,r)=>{let o={t:e instanceof Function?e():e,f:r},n=t[w];o.t[p]={},n[_].push(o),N(n);for(let[e,r]of l(n))x(t,e,r,1,o);return o.t},C=(e,t)=>{for(let[r,o]of l(t)){let t=e[r];P(t)&&P(o)?C(t,o):e[r]=o}for(let r in e)f(t,r)||delete e[r];let r=n(t),o=Array.isArray(e);if(o||n(e).some((e,t)=>e!==r[t])){let l=e[w];if(o)e.length=t.length;else{++l[g].val;let e={...l};for(let e of r)delete l[e];for(let t of r)l[t]=e[t]}for(let{t:e}of j(l)){let{firstChild:t,[p]:o}=e;for(let l of r)t===o[l]?t=t.nextSibling:e.insertBefore(o[l],t)}}return e},E=(e,n)=>{r=1;try{return C(e,n instanceof Function?Array.isArray(e)?n(e.filter(e=>1)):o(n(l(e))):n)}finally{r=t}},R=e=>Array.isArray(e)?e.filter(e=>1).map(R):P(e)?o(l(e).map(([e,t])=>[e,R(t)])):e;window.vanX={calc:S,reactive:O,stateFields:v,raw:D,list:k,replace:E,compact:R}}
